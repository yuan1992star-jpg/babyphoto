<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>宝贝成长时光机</title>
    <!-- 优先使用本地资源，支持完全离线运行 -->
    <script src="/assets/js/tailwind.js"></script>
    
    <link href="/assets/fonts/noto_sans_sc_kuai_le.css" rel="stylesheet">
    
    <script src="/assets/js/vue.global.js"></script>
    
    <script src="/assets/js/lucide.min.js"></script>
    
    <style>
        :root {
            --primary-pink: #ffafbd;
            --primary-blue: #c9ffbf;
            --soft-bg: #fdfbfb;
        }
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(120deg, #fdfbfb 0%, #ebedee 100%);
            min-height: 100vh;
        }
        .baby-title {
            font-family: 'ZCOOL KuaiLe', cursive;
        }
        .timeline-dot::before {
            content: '';
            position: absolute;
            left: -25px;
            top: 12px;
            width: 18px;
            height: 18px;
            background: white;
            border: 4px solid #f472b6;
            border-radius: 50%;
            z-index: 10;
        }
        .timeline-line {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #fbcfe8;
            margin-left: -1px;
        }
        .photo-card {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .photo-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .glass-morphism {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        [v-cloak] { display: none; }
    </style>
</head>
<body class="text-slate-700">
    <div id="app" v-cloak class="flex flex-col md:flex-row min-h-screen">
        
        <!-- Global Drag Overlay -->
        <div v-if="isGlobalDragging" class="fixed inset-0 z-[100] bg-pink-400/80 backdrop-blur-md flex flex-col items-center justify-center text-white p-8 pointer-events-none transition-all">
            <div class="border-4 border-dashed border-white/50 rounded-3xl w-full h-full flex flex-col items-center justify-center animate-pulse">
                <i data-lucide="sparkles" class="w-24 h-24 mb-6"></i>
                <h2 class="text-4xl baby-title">把回忆交给我吧...</h2>
                <p class="text-xl mt-4 opacity-80">支持批量拖入照片和视频</p>
            </div>
        </div>

        <!-- Left Sidebar (Desktop) -->
        <aside class="w-full md:w-80 glass-morphism sticky top-0 md:h-screen z-20 flex flex-col p-6 shadow-xl border-r">
            <div class="flex items-center space-x-3 mb-10">
                <div class="bg-gradient-to-tr from-pink-400 to-rose-400 p-3 rounded-2xl shadow-lg shadow-pink-200">
                    <i data-lucide="baby" class="w-8 h-8 text-white"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold baby-title text-rose-500">成长时光机</h1>
                    <p class="text-xs text-slate-400 font-medium">RECORD EVERY MOMENT</p>
                </div>
            </div>

            <nav class="flex-1 space-y-2 overflow-y-auto pr-2 custom-scrollbar">
                <div class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4">时间航线</div>
                <div v-for="group in groups" :key="group.date" class="relative pl-6 py-2 cursor-pointer group" @click="scrollToGroup(group.date)">
                    <div class="absolute left-1 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-pink-300 group-hover:scale-150 transition-transform"></div>
                    <div class="text-sm font-medium text-slate-600 group-hover:text-pink-500 transition-colors">{{ formatDisplayDate(group.date) }}</div>
                    <div class="text-[10px] text-slate-400">{{ group.photos.length }} 枚回忆</div>
                </div>
            </nav>

            <button @click="showUpload = !showUpload" class="mt-8 w-full bg-gradient-to-r from-pink-500 to-rose-500 text-white font-bold py-4 rounded-2xl shadow-lg shadow-pink-200 hover:shadow-pink-300 hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center space-x-2">
                <i data-lucide="plus-circle" class="w-5 h-5"></i>
                <span>导入新回忆</span>
            </button>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-4 md:p-10 relative">
            <!-- Mobile Header Decor -->
            <div class="md:hidden flex justify-between items-center mb-8">
                <h1 class="text-2xl baby-title text-rose-500">成长时光机</h1>
                <button @click="showUpload = !showUpload" class="bg-pink-500 text-white p-3 rounded-full shadow-lg">
                    <i data-lucide="plus" class="w-6 h-6"></i>
                </button>
            </div>

            <!-- Upload Panel -->
            <transition name="fade">
                <div v-show="showUpload" class="mb-10">
                    <div id="drop-zone" @dragover.prevent="onDragOver" @dragleave.prevent="onDragLeave" @drop.prevent="onDrop" 
                        class="relative glass-morphism rounded-3xl p-10 text-center border-2 border-dashed border-pink-200 hover:border-pink-400 transition-all cursor-pointer group"
                        :class="{'bg-pink-50 border-pink-400': isDragging}">
                        <input type="file" ref="fileInput" class="hidden" multiple @change="handleFileSelect" accept="image/*,video/*">
                        <div class="flex flex-col items-center" @click="$refs.fileInput.click()">
                            <div class="bg-pink-100 p-5 rounded-full text-pink-500 mb-6 group-hover:rotate-12 transition-transform">
                                <i data-lucide="camera" class="w-12 h-12"></i>
                            </div>
                            <h3 class="text-xl font-bold text-slate-700">点击或拖入照片/视频</h3>
                            <p class="text-slate-400 mt-2">我们会根据拍摄日期自动整理它们</p>
                        </div>

                        <!-- Upload Progress -->
                        <div v-if="uploadingFiles.length > 0" class="mt-8 grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div v-for="(file, index) in uploadingFiles" :key="index" class="bg-white/50 p-4 rounded-2xl border border-pink-50 flex items-center space-x-4">
                                <div class="w-12 h-12 rounded-lg bg-slate-100 flex-shrink-0 flex items-center justify-center text-slate-400">
                                    <i data-lucide="file-text" class="w-6 h-6"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex justify-between text-xs mb-1">
                                        <span class="truncate font-medium">{{ file.name }}</span>
                                        <span :class="file.status === 'success' ? 'text-green-500' : 'text-pink-500'">{{ file.progress }}%</span>
                                    </div>
                                    <div class="h-1.5 w-full bg-slate-100 rounded-full overflow-hidden">
                                        <div class="h-full bg-gradient-to-r from-pink-400 to-rose-400 transition-all duration-300" :style="{width: file.progress + '%'}"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </transition>

            <!-- Gallery -->
            <div v-if="loading" class="flex flex-col items-center justify-center py-40">
                <div class="w-16 h-16 border-4 border-pink-200 border-t-pink-500 rounded-full animate-spin"></div>
                <p class="mt-4 text-slate-400 baby-title text-xl">时光机启动中...</p>
            </div>

            <div v-else-if="groups.length === 0" class="flex flex-col items-center justify-center py-32 bg-white/40 rounded-[3rem] border border-white">
                <div class="relative mb-8">
                    <div class="absolute -inset-4 bg-pink-100 rounded-full animate-ping opacity-25"></div>
                    <div class="relative bg-white p-8 rounded-full shadow-xl text-pink-300">
                        <i data-lucide="camera-off" class="w-20 h-20"></i>
                    </div>
                </div>
                <h3 class="text-2xl font-bold text-slate-600 baby-title">这里空空如也</h3>
                <p class="text-slate-400 mt-2">点击左侧“导入新回忆”开启宝宝的时光旅程</p>
            </div>

            <div v-else class="space-y-16 pl-4 md:pl-10 relative">
                <div class="timeline-line hidden md:block"></div>
                
                <div v-for="group in visibleGroups()" :key="group.date" :id="'group-'+group.date" class="relative timeline-dot">
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold text-slate-800 baby-title inline-block relative pb-2 pl-1">
                            <span class="relative z-10">{{ formatDisplayDate(group.date) }}</span>
                            <span class="absolute bottom-1 left-0 w-full h-2 bg-pink-200 -z-10 rounded-full opacity-60"></span>
                        </h2>
                        <div class="ml-4 mt-2 flex items-center gap-4 flex-wrap">
                            <span class="text-sm font-bold text-slate-400">{{ group.photos.length }} 枚瞬间</span>
                            <span v-if="birthDate" class="text-sm font-bold text-pink-500 bg-pink-50 px-3 py-1 rounded-full">
                                宝宝 {{ getBabyAge(group.date) }}
                            </span>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
                        <div v-for="photo in (group.expanded ? group.photos : group.photos.slice(0, 10))" :key="photo.url" @click="openLightbox(photo)" 
                            class="photo-card aspect-square rounded-[2rem] overflow-hidden bg-white shadow-sm border-4 border-white cursor-pointer group relative">
                            
                            <img v-if="photo.type === 'image'" :src="photo.url" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-125" loading="lazy">
                            <div v-else class="w-full h-full relative">
                                <video :src="photo.url" class="w-full h-full object-cover"></video>
                                <div class="absolute inset-0 flex items-center justify-center bg-black/10 group-hover:bg-black/30 transition-colors">
                                    <div class="bg-white/90 p-3 rounded-full shadow-lg group-hover:scale-110 transition-transform">
                                        <i data-lucide="play" class="w-6 h-6 text-rose-500 fill-current"></i>
                                    </div>
                                </div>
                            </div>

                            <div class="absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
                            <div class="absolute bottom-4 left-4 right-4 flex justify-between items-center translate-y-8 group-hover:translate-y-0 transition-transform duration-300">
                                <span class="text-[10px] bg-white/20 backdrop-blur-md text-white px-2 py-1 rounded-lg border border-white/30">
                                    {{ photo.type === 'image' ? 'PHOTO' : 'VIDEO' }}
                                </span>
                                <div class="bg-white p-2 rounded-xl text-rose-500 shadow-lg">
                                    <i data-lucide="maximize-2" class="w-4 h-4"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div v-if="group.photos.length > 10" class="mt-6 flex justify-center">
                         <button @click="toggleExpand(group)" class="px-6 py-2 bg-white border-2 border-pink-200 rounded-full text-pink-500 font-bold hover:bg-pink-50 hover:border-pink-300 transition-all flex items-center space-x-2 shadow-sm">
                            <span v-if="!group.expanded">查看剩余 {{ group.photos.length - 10 }} 枚回忆</span>
                            <span v-else>收起</span>
                            <i :data-lucide="group.expanded ? 'chevron-up' : 'chevron-down'" class="w-4 h-4"></i>
                         </button>
                    </div>
                </div>

                <!-- 加载更多指示器 -->
                <div v-if="visibleCount < groups.length" class="mt-8 flex justify-center">
                    <button 
                        @click="loadMore" 
                        :disabled="isLoadingMore"
                        class="px-6 py-3 bg-gradient-to-r from-pink-500 to-rose-500 text-white font-bold rounded-full shadow-lg shadow-pink-200 hover:shadow-pink-300 hover:scale-[1.02] active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2">
                        <span v-if="!isLoadingMore">加载更多回忆 ({{ groups.length - visibleCount }} 个日期)</span>
                        <span v-else class="flex items-center space-x-2">
                            <div class="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                            <span>加载中...</span>
                        </span>
                    </button>
                </div>
            </div>
        </main>

        <!-- Birth Date Input Modal -->
        <transition name="fade">
            <div v-if="showBirthDateModal" class="fixed inset-0 z-[2000] bg-slate-900/80 backdrop-blur-md flex items-center justify-center p-4">
                <div class="bg-white rounded-3xl shadow-2xl max-w-md w-full p-8 relative" @click.stop>
                    <div class="text-center mb-6">
                        <div class="bg-gradient-to-tr from-pink-400 to-rose-400 p-4 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center shadow-lg">
                            <i data-lucide="heart" class="w-10 h-10 text-white"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-slate-800 baby-title mb-2">欢迎使用成长时光机</h2>
                        <p class="text-slate-500 text-sm">请设置宝宝的出生日期，我们将为您记录每一个珍贵瞬间</p>
                    </div>
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-slate-700 mb-2">出生日期</label>
                        <input 
                            type="date" 
                            v-model="birthDateInput" 
                            class="w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:border-pink-400 focus:outline-none transition-colors text-slate-700"
                            :max="todayDate"
                        >
                    </div>
                    <button 
                        @click="saveBirthDate" 
                        :disabled="!birthDateInput"
                        class="w-full bg-gradient-to-r from-pink-500 to-rose-500 text-white font-bold py-4 rounded-xl shadow-lg shadow-pink-200 hover:shadow-pink-300 hover:scale-[1.02] active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100">
                        开始记录成长
                    </button>
                </div>
            </div>
        </transition>

        <!-- Lightbox -->
        <transition name="zoom">
            <div v-if="lightbox.show" class="fixed inset-0 z-[1000] bg-slate-900/95 backdrop-blur-xl flex items-center justify-center p-4 md:p-10" @click="closeLightbox">
                <button class="absolute top-8 right-8 text-white/50 hover:text-white transition-colors" @click.stop="closeLightbox">
                    <i data-lucide="x-circle" class="w-10 h-10"></i>
                </button>
                <div class="max-w-6xl w-full h-full flex flex-col items-center justify-center" @click.stop>
                    <div class="relative w-full h-full flex items-center justify-center">
                        <img v-if="lightbox.photo.type === 'image'" :src="lightbox.photo.url" class="max-w-full max-h-full object-contain rounded-2xl shadow-2xl">
                        <video v-else :src="lightbox.photo.url" controls autoplay class="max-w-full max-h-full rounded-2xl shadow-2xl"></video>
                    </div>
                </div>
            </div>
        </transition>
    </div>

    <script>
        const { createApp, ref, onMounted, onUnmounted } = Vue;

        createApp({
            setup() {
                const groups = ref([]);
                const loading = ref(true);
                const showUpload = ref(false);
                const isDragging = ref(false);
                const isGlobalDragging = ref(false);
                const uploadingFiles = ref([]);
                const lightbox = ref({ show: false, photo: null });
                const showBirthDateModal = ref(false);
                const birthDateInput = ref('');
                const birthDate = ref(null);
                const todayDate = new Date().toISOString().split('T')[0];
                const visibleCount = ref(10); // 初始显示10个日期分组
                const isLoadingMore = ref(false);
                let dragCounter = 0;

                const fetchPhotos = async () => {
                    loading.value = true;
                    try {
                        const res = await fetch('/api/photos');
                        const data = await res.json();
                        groups.value = data.map(g => ({ ...g, expanded: false }));
                        visibleCount.value = 10; // 重置可见数量
                        setTimeout(() => lucide.createIcons(), 100);
                    } catch (e) {
                        console.error("加载失败", e);
                    } finally {
                        loading.value = false;
                    }
                };

                // 计算可见的分组
                const visibleGroups = () => {
                    return groups.value.slice(0, visibleCount.value);
                };

                // 加载更多分组
                const loadMore = () => {
                    if (isLoadingMore.value || visibleCount.value >= groups.value.length) {
                        return;
                    }
                    isLoadingMore.value = true;
                    // 模拟加载延迟，让用户看到加载效果
                    setTimeout(() => {
                        visibleCount.value = Math.min(visibleCount.value + 10, groups.value.length);
                        isLoadingMore.value = false;
                        setTimeout(() => lucide.createIcons(), 100);
                    }, 300);
                };

                // 滚动监听
                const handleScroll = () => {
                    if (isLoadingMore.value || visibleCount.value >= groups.value.length) {
                        return;
                    }
                    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                    const windowHeight = window.innerHeight;
                    const documentHeight = document.documentElement.scrollHeight;
                    // 当滚动到距离底部200px时加载更多
                    if (scrollTop + windowHeight >= documentHeight - 200) {
                        loadMore();
                    }
                };

                const formatDisplayDate = (dateStr) => {
                    const [y, m, d] = dateStr.split('-');
                    return `${y}年${parseInt(m)}月${parseInt(d)}日`;
                };

                // 计算宝宝年龄
                const getBabyAge = (photoDateStr) => {
                    if (!birthDate.value) return '';
                    
                    const [photoY, photoM, photoD] = photoDateStr.split('-').map(Number);
                    const photoDate = new Date(photoY, photoM - 1, photoD);
                    const birth = new Date(birthDate.value);
                    
                    // 计算总天数
                    const diffTime = photoDate - birth;
                    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                    
                    if (diffDays < 0) return '还未出生';
                    if (diffDays === 0) return '出生当天';
                    
                    // 计算年、月、日
                    let years = photoY - birth.getFullYear();
                    let months = photoM - (birth.getMonth() + 1);
                    let days = photoD - birth.getDate();
                    
                    // 调整月份和天数
                    if (days < 0) {
                        months--;
                        const prevMonth = new Date(photoY, photoM - 1, 0);
                        days += prevMonth.getDate();
                    }
                    if (months < 0) {
                        years--;
                        months += 12;
                    }
                    
                    const parts = [];
                    // 总是显示天数（约多少天）
                    parts.push(`约${diffDays}天`);
                    
                    // 如果有月数，显示月数
                    if (months > 0) {
                        parts.push(`${months}个月`);
                    }
                    
                    // 如果有年数，显示岁数
                    if (years > 0) {
                        parts.push(`${years}岁`);
                    }
                    
                    // 如果小于1个月，只显示天数
                    if (diffDays < 30) {
                        return `约${diffDays}天`;
                    }
                    
                    // 按 岁、月、天的顺序显示
                    const resultParts = [];
                    if (years > 0) resultParts.push(`${years}岁`);
                    if (months > 0) resultParts.push(`${months}个月`);
                    resultParts.push(`约${diffDays}天`);
                    
                    return resultParts.join(' ');
                };

                // 保存出生日期
                const saveBirthDate = async () => {
                    if (!birthDateInput.value) return;
                    
                    try {
                        const res = await fetch('/api/birthdate', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                birthDate: birthDateInput.value
                            })
                        });
                        
                        if (res.ok) {
                            const data = await res.json();
                            birthDate.value = data.birthDate;
                            showBirthDateModal.value = false;
                        } else {
                            const error = await res.json();
                            alert('保存失败: ' + (error.error || '未知错误'));
                        }
                    } catch (e) {
                        console.error('保存出生日期失败', e);
                        alert('保存失败，请重试');
                    }
                };

                // 加载出生日期
                const loadBirthDate = async () => {
                    try {
                        const res = await fetch('/api/birthdate');
                        if (res.ok) {
                            const data = await res.json();
                            if (data.birthDate) {
                                birthDate.value = data.birthDate;
                                showBirthDateModal.value = false;
                            } else {
                                showBirthDateModal.value = true;
                            }
                        } else {
                            // 如果接口出错，显示输入框
                            showBirthDateModal.value = true;
                        }
                    } catch (e) {
                        console.error('加载出生日期失败', e);
                        // 出错时显示输入框
                        showBirthDateModal.value = true;
                    }
                };

                const handleFiles = async (files) => {
                    // 立即重置全局拖拽状态
                    isGlobalDragging.value = false;
                    dragCounter = 0;
                    isDragging.value = false;
                    
                    showUpload.value = true;
                    const uploadPromises = [];
                    
                    for (const file of files) {
                        const uploadItem = { name: file.name, progress: 0, status: 'uploading' };
                        uploadingFiles.value.unshift(uploadItem);

                        const formData = new FormData();
                        formData.append('files', file);

                        const uploadPromise = new Promise((resolve) => {
                            const xhr = new XMLHttpRequest();
                            xhr.open('POST', '/upload', true);
                            xhr.upload.onprogress = (e) => {
                                if (e.lengthComputable) {
                                    uploadItem.progress = Math.round((e.loaded / e.total) * 100);
                                }
                            };
                            xhr.onload = () => {
                                if (xhr.status === 200) {
                                    uploadItem.status = 'success';
                                    uploadItem.progress = 100;
                                } else {
                                    uploadItem.status = 'error';
                                }
                                resolve();
                            };
                            xhr.onerror = () => {
                                uploadItem.status = 'error';
                                resolve();
                            };
                            xhr.send(formData);
                        });
                        
                        uploadPromises.push(uploadPromise);
                    }
                    
                    // 等待所有文件上传完成
                    await Promise.all(uploadPromises);
                    
                    // 刷新照片列表
                    await fetchPhotos();
                    
                    // 延迟后隐藏上传面板和清除上传文件列表
                    setTimeout(() => {
                        showUpload.value = false;
                        uploadingFiles.value = [];
                    }, 2000);
                };

                const handleFileSelect = (e) => handleFiles(e.target.files);
                const onDragOver = () => isDragging.value = true;
                const onDragLeave = () => isDragging.value = false;
                const onDrop = (e) => {
                    isDragging.value = false;
                    handleFiles(e.dataTransfer.files);
                };

                window.addEventListener('dragenter', (e) => {
                    e.preventDefault();
                    dragCounter++;
                    if (uploadingFiles.value.length === 0) {
                        isGlobalDragging.value = true;
                    }
                });

                window.addEventListener('dragleave', (e) => {
                    e.preventDefault();
                    dragCounter--;
                    if (dragCounter <= 0) {
                        isGlobalDragging.value = false;
                        dragCounter = 0;
                    }
                });

                window.addEventListener('dragover', (e) => {
                    e.preventDefault();
                });

                window.addEventListener('drop', (e) => {
                    e.preventDefault();
                    isGlobalDragging.value = false;
                    dragCounter = 0;
                    if (e.dataTransfer.files.length > 0) {
                        handleFiles(e.dataTransfer.files);
                    }
                });

                const scrollToGroup = (id) => {
                    const el = document.getElementById('group-' + id);
                    if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
                };

                const toggleExpand = (group) => {
                    group.expanded = !group.expanded;
                    setTimeout(() => lucide.createIcons(), 100);
                };

                const openLightbox = (photo) => {
                    lightbox.value = { show: true, photo };
                    setTimeout(() => lucide.createIcons(), 100);
                };

                const closeLightbox = () => lightbox.value.show = false;

                onMounted(() => {
                    loadBirthDate();
                    fetchPhotos();
                    lucide.createIcons();
                    // 添加滚动监听
                    window.addEventListener('scroll', handleScroll);
                });

                // 组件卸载时移除滚动监听
                onUnmounted(() => {
                    window.removeEventListener('scroll', handleScroll);
                });

                return {
                    groups, loading, showUpload, isDragging, isGlobalDragging, uploadingFiles, lightbox,
                    showBirthDateModal, birthDateInput, birthDate, todayDate,
                    visibleCount, isLoadingMore, visibleGroups, loadMore,
                    formatDisplayDate, getBabyAge, saveBirthDate, loadBirthDate,
                    handleFileSelect, onDragOver, onDragLeave, onDrop,
                    openLightbox, closeLightbox, scrollToGroup, toggleExpand
                };
            }
        }).mount('#app');
    </script>

    <style>
        .fade-enter-active, .fade-leave-active { transition: opacity 0.3s ease, transform 0.3s ease; }
        .fade-enter-from, .fade-leave-to { opacity: 0; transform: translateY(-20px); }
        
        .zoom-enter-active, .zoom-leave-active { transition: all 0.3s ease; }
        .zoom-enter-from, .zoom-leave-to { opacity: 0; transform: scale(0.9); }

        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #fbcfe8; border-radius: 10px; }
    </style>
</body>
</html>
